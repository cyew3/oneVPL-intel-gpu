<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" InitialTargets="Win8SdkCheck;PerlPresenseCheck">
  <ImportGroup Label="PropertySheets" />
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Platform)'=='Win32'">
    <PerlDir>$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Perl', null, null, RegistryView.Registry32))</PerlDir>
     </PropertyGroup>
  <PropertyGroup Condition="'$(Platform)'=='x64'">
    <PerlDir>$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Perl', null, null, RegistryView.Registry64))</PerlDir>
  </PropertyGroup>
  <ItemGroup>
    <PerlLibs Include="$(PerlDir)\lib\CORE\libperl5??.a;$(PerlDir)\lib\CORE\perl5??.lib"/>
  </ItemGroup>
  <PropertyGroup>
    <PerlLib>@(PerlLibs)</PerlLib>
  </PropertyGroup>
  <PropertyGroup>
    <WindowsSdk8Path Condition="Exists('$(MINIDDK_ROOT)')">$(MINIDDK_ROOT)</WindowsSdk8Path>
    <WindowsSdk8Path Condition="!Exists('$(MINIDDK_ROOT)')">$(registry:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\Windows\v8.1@InstallationFolder)"</WindowsSdk8Path>
    <OutDir>$(MfxBuildDir)win_$(Platform)\lib\</OutDir>
    <IntDir>$(MfxBuildDir)win_$(Platform)\objs\$(Configuration)\$(ProjectName)\</IntDir>
    <IncludePath>$(WindowsSdk8Path)\Include\um;$(WindowsSdk8Path)\Include\shared;$(IncludePath)</IncludePath>
  </PropertyGroup>
  <Target Name="Win8SdkCheck" BeforeTargets="Build">
    <Error Text=" Unable to find Windows SDK 8.1 by both MINIDDK_ROOT and registry lookup. Please check if it installed correctly or reinstall it from http://msdn.microsoft.com/en-us/windows/desktop/hh852363.aspx."
       Condition ="!Exists('$(WindowsSdk8Path)')" />
  </Target>
  <Target Name="PerlPresenseCheck">
    <Error Text=" Unable to find installed Perl that is relevant to target bitness (Win32||x64) by registry lookup.
           Please install bitness corresponding Perl or choose another platform type.
           For more info please goto http://wiki.ith.intel.com/display/MediaSDK/Debugging+behavior+tests"
       Condition ="!Exists('$(PerlDir)')" />
  </Target>
  <PropertyGroup Condition="'$(Platform)'=='Win32'">
    <LibraryPath>$(WindowsSdk8Path)\Lib\win8\um\x86;$(LibraryPath)</LibraryPath>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Platform)'=='x64'">
    <LibraryPath>$(WindowsSdk8Path)\Lib\win8\um\x64;$(LibraryPath)</LibraryPath>
  </PropertyGroup>
  <ItemDefinitionGroup />
  <ItemGroup />
</Project>
